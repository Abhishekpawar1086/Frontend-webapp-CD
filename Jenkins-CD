pipeline {
  agent any

  environment {
    GCP_PROJECT_ID = 'final-project-453412'
    GAR_REPO = 'us-central1-docker.pkg.dev/final-project-453412/docker-images'
    IMAGE_NAME = 'frontend-webapp'
    IMAGE_TAG = 'latest'
    KUBE_NAMESPACE = 'frontend-app'
    // HELM_CHART_PATH = 'path/to/your/helm/chart'
  }
stages {
       stage('Clean Workspace') {
            steps {
                cleanWs() // Cleans the workspace
            }
        }
stage('Clone Repository') {
      steps {
        script {
          echo "Cloning repository from ${GIT_REPO_URL} (branch: ${GIT_BRANCH})..."
          git branch: 'main', credentialsId: 'Jenkins-token', url: 'https://github.com/Abhishekpawar1086/Frontend-webapp-CD.git'
        }
      }
    }
 stage('Authenticate with GCP') {
      steps {
       withCredentials([file(credentialsId: 'gcp-artifact-registry-key', variable: 'gcp-key')]) {
          sh """
            gcloud auth activate-service-account --key-file=${gcp-key}
            gcloud auth configure-docker ${GAR_REPO}
          """
        }
      }
    }
  }
 }

